<!-- Copyright (c) 2025 Bloxcraft Studios -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="The Unblocked Games Site For You To Play!">
<meta property="og:title" content="Bloxcraft UBG Games">
<meta property="og:type" content="article">
<meta property="og:url" content="/">
<meta property="og:site_name" content="Bloxcraft UBG">
<meta property="og:image" content="/gamepage_banner.png" />
<meta name="theme-color" content="#5555FF"> 
<meta property="og:description" content="The Unblocked Games Site You Can Play Everyday! It Also has Some Custom Games.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bloxcraft UBG - Browse Mode</title>
<link rel="shortcut icon" type="image/png" href="/bloxcraft.png">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
body { margin:0; font-family:'Orbitron',sans-serif; color:#fff; display:flex; flex-direction:column; height:100vh; background: linear-gradient(135deg,#1e3c72,#2a5298);}
.tabs{display:flex;background:linear-gradient(90deg,#4facfe,#00f2fe);padding:5px;overflow-x:auto;z-index:100;}
.tab{display:flex;align-items:center;background:rgba(255,255,255,0.2);padding:5px 10px;margin-right:5px;border-radius:5px;cursor:pointer;white-space:nowrap;transition:background 0.3s, transform 0.2s, margin-left 0.3s, opacity 0.3s; opacity:0; transform:translateX(50px);}
.tab.active{background:rgba(255,255,255,0.5);font-weight:bold; transform:scale(1.05); animation:pulse 1s infinite;}
.tab img{width:16px;height:16px;margin-right:5px;display:none;}
.tab-close{margin-left:8px;cursor:pointer;font-weight:bold;width:18px;height:18px;display:flex;align-items:center;justify-content:center;border:2px solid red;border-radius:50%;transition:background 0.2s, transform 0.2s; color:red;}
.tab-close:hover{background:red;color:white; transform:scale(1.2);}
.add-tab{font-size:20px;padding:0 10px;cursor:pointer;transition:transform 0.2s;}
.add-tab:hover{transform:scale(1.2);}
.controls{display:flex;padding:10px;background:rgba(0,0,0,0.3);align-items:center;gap:10px;z-index:99;}
.url-bar{flex:1;background:rgba(255,255,255,0.2);border:none;color:#fff;padding:8px 12px;border-radius:5px;font-size:14px;pointer-events:none; transition:background 0.3s;}
.refresh-btn,.fullscreen-btn{padding:8px 12px;border:none;border-radius:5px;background:#4facfe;color:#fff;cursor:pointer;font-weight:bold;transition:background 0.3s, transform 0.2s;}
.refresh-btn:hover,.fullscreen-btn:hover{background:#00f2fe; transform:scale(1.05);}
iframe{flex:1;border:none;width:100%;transition:all 0.3s;}
.iframe-fullscreen{position:fixed!important;top:0;left:0;width:100vw!important;height:100vh!important;z-index:9999;}
#fullscreenPopup{position:fixed;top:-50px;right:20px;background:rgba(0,0,0,0.7);color:#fff;padding:10px 15px;border-radius:5px;font-weight:bold;display:block;z-index:10000;transition:top 0.5s, opacity 0.5s;opacity:0;}
#fullscreenPopup.show{opacity:1; top:20px;}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes pulse{0%,100%{transform:scale(1.05)}50%{transform:scale(1.1)}}
@media (max-width:768px){.tabs{flex-wrap:wrap}.controls{flex-direction:column;align-items:stretch}.refresh-btn,.fullscreen-btn{width:100%;margin-top:5px}}
</style>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W0KXN0103E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-W0KXN0103E');
</script>
</head>
<body>

<div class="tabs" id="tabs"><div class="add-tab" id="addTab">+</div></div>
<div class="controls" id="controls">
  <input type="text" id="urlBar" class="url-bar" value="bloxcraft://newtab" readonly>
  <button class="refresh-btn" id="refreshBtn">⟳ Refresh</button>
  <button class="fullscreen-btn" id="fullscreenBtn">⛶ Fullscreen</button>
</div>
<iframe id="browserFrame" src="/assets/home/newtab/"></iframe>
<div id="fullscreenPopup">Press ESC To Exit</div>

<script>
const tabsContainer=document.getElementById('tabs');
const addTabBtn=document.getElementById('addTab');
const urlBar=document.getElementById('urlBar');
const browserFrame=document.getElementById('browserFrame');
const refreshBtn=document.getElementById('refreshBtn');
const fullscreenBtn=document.getElementById('fullscreenBtn');
const controls=document.getElementById('controls');
const fullscreenPopup=document.getElementById('fullscreenPopup');

let tabs=[]; let currentTabId=0; let tabCount=0;

function showPopup(msg){
  fullscreenPopup.textContent=msg;
  fullscreenPopup.classList.add('show');
  setTimeout(()=>fullscreenPopup.classList.remove('show'),2000);
}

function createTab(src,label){
  const tabId=tabCount++;
  const tab={id:tabId,src:src,label:label||"New Tab"};
  tabs.push(tab);

  const tabElem=document.createElement('div'); tabElem.className='tab'; tabElem.id='tab-'+tabId;

  const favicon=document.createElement('img'); favicon.alt=''; tabElem.appendChild(favicon);
  const spanLabel=document.createElement('span'); spanLabel.textContent=tab.label; tabElem.appendChild(spanLabel);
  const closeBtn=document.createElement('span'); closeBtn.className='tab-close'; closeBtn.textContent='×'; tabElem.appendChild(closeBtn);

  tabsContainer.insertBefore(tabElem, addTabBtn);

  requestAnimationFrame(()=>{ tabElem.style.opacity='1'; tabElem.style.transform='translateX(0)'; });

  tabElem.addEventListener('click',e=>{
    if(e.target.classList.contains('tab-close')){ closeTab(tabId); } else { switchTab(tabId); }
  });

  switchTab(tabId);
}

function switchTab(id){
  currentTabId=id;
  const tab=tabs.find(t=>t.id===id);
  browserFrame.src=tab.src;
  updateTabAndUrl(tab);
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  const activeTabElem=document.getElementById('tab-'+id);
  if(activeTabElem) activeTabElem.classList.add('active');
}

function updateTabAndUrl(tab){
  try{
    const iframeWin = browserFrame.contentWindow;
    const iframeDoc = iframeWin.document;
    const tabElem = document.getElementById('tab-'+tab.id);

    const title = iframeDoc.title || tab.label;
    tabElem.querySelector('span').textContent = title;

    const linkIcon = iframeDoc.querySelector("link[rel~='icon']");
    const img = tabElem.querySelector('img');
    if(linkIcon){ img.src = linkIcon.href; img.style.display='inline-block'; } else { img.style.display='none'; }

    const path = new URL(iframeWin.location.href, window.location.origin).pathname;

    let bcUrl = 'bloxcraft://';
    if(path === '/assets/home/newtab/' || path === '/assets/home/newtab/index.html'){ 
      bcUrl += 'newtab'; 
    } else if(path === '/') {
      bcUrl += 'home';
    } else {
      bcUrl += path.replace(/^\/|\/$/g,''); 
    }

    urlBar.value = bcUrl;
  } catch(err){
    const tabElem=document.getElementById('tab-'+tab.id);
    tabElem.querySelector('img').style.display='none';
    tabElem.querySelector('span').textContent=tab.label;
    urlBar.value='bloxcraft://'+tab.label.toLowerCase().replace(/\s/g,'');
  }
}

function attachIframeNavigation(){
  try{
    const iframeWin=browserFrame.contentWindow;
    const iframeDoc=iframeWin.document;

    iframeDoc.querySelectorAll('a').forEach(a=>{
      const href=a.getAttribute('href');
      if(href && (href.startsWith('http://') || href.startsWith('https://'))){
        a.setAttribute('target','_blank');
      } else if(href){
        a.addEventListener('click',e=>{
          e.preventDefault();
          iframeWin.location.href=href;
        });
      }
    });

    const originalPush=iframeWin.history.pushState;
    iframeWin.history.pushState=function(state,title,url){ originalPush.apply(this,arguments); setTimeout(()=>updateTabAndUrl(tabs.find(t=>t.id===currentTabId)),0); };
    const originalReplace=iframeWin.history.replaceState;
    iframeWin.history.replaceState=function(state,title,url){ originalReplace.apply(this,arguments); setTimeout(()=>updateTabAndUrl(tabs.find(t=>t.id===currentTabId)),0); };
    iframeWin.addEventListener('popstate',()=>updateTabAndUrl(tabs.find(t=>t.id===currentTabId)));

    iframeDoc.addEventListener('keydown', (e)=>{
      if(e.key==='Escape' || e.key==='Esc'){
        if(browserFrame.classList.contains('iframe-fullscreen')){
          browserFrame.classList.remove('iframe-fullscreen');
          controls.style.display='flex';
          tabsContainer.style.display='flex';
          showPopup("Exited Fullscreen");
        }
      }
    });

  }catch(err){}
}

function closeTab(id){
  const index=tabs.findIndex(t=>t.id===id);
  if(index>-1){ 
    const tabElem=document.getElementById('tab-'+id);
    if(tabElem){
      tabElem.style.transform='translateX(50px)';
      tabElem.style.opacity='0';
      setTimeout(()=>tabElem.remove(),300);
    }
    tabs.splice(index,1);
    if(currentTabId===id&&tabs.length>0){ switchTab(tabs[0].id); } 
    else if(tabs.length===0){ createTab('/assets/home/newtab/','New Tab'); }
  }
}

addTabBtn.addEventListener('click',()=>{ createTab('/assets/home/newtab/','New Tab'); });
refreshBtn.addEventListener('click',()=>{ browserFrame.contentWindow.location.reload(); });
fullscreenBtn.addEventListener('click',()=>{
  browserFrame.classList.toggle('iframe-fullscreen');
  controls.style.display=browserFrame.classList.contains('iframe-fullscreen')?'none':'flex';
  tabsContainer.style.display=browserFrame.classList.contains('iframe-fullscreen')?'none':'flex';
  if(browserFrame.classList.contains('iframe-fullscreen')) showPopup("Press ESC To Exit");
});

if(/Mobi|Android/i.test(navigator.userAgent)){ tabsContainer.style.flexWrap='wrap'; urlBar.style.fontSize='16px'; }

createTab('/assets/home/newtab/','New Tab');

browserFrame.addEventListener('load',()=>{
  const tab=tabs.find(t=>t.id===currentTabId);
  if(tab){ updateTabAndUrl(tab); attachIframeNavigation(); }
});
</script>
</body>
</html>
